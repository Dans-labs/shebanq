{{ left_sidebar_enabled = True }}
{{ extend 'layout.html' }}

{{ block head }}
    <script type="text/javascript">
var save_url = "{{=URL('default', 'save_viewsettings')}}"
var view_url = "{{=XML(URL(vars=request.vars, host=True))}}"
    </script>
{{ end }}

{{ include 'passage/browser_form.html' }}

{{
    ua = request.user_agent().browser.name
}}

{{ if verses != None: }}
    {{if len(verses.verses) > 0: }}
        {{include 'passage/view_settings.html'}}
        {{ for verse in verses.verses:}}
            <div class="txt_p"><span class="vnum">{{=verse.verse_num}}&nbsp;</span>{{=XML(verse.plain_text(ua))}}</div>
            <div class="txt_il"><span class="vnum">{{=verse.verse_num}}&nbsp;</span>{{=XML(verse.rich_text(ua))}}</div>
        {{ pass }}
    {{ pass }}
{{ pass }}


{{ block left_sidebar }}
{{ if request.vars.chapter: }}
<div>
    <a id="s_words" href="#">show words</a>
    <a id="h_words" href="#">hide words</a>
</div>
<div id='wbar'>
    {{include 'passage/word_form.html'}}
</div>
<div>
    <span id="s_queries">{{=A(
            'get queries',
            _id='fetchqueries',
            callback=URL('passage', 'query_form', vars=dict(book=request.vars.book, chapter=request.vars.chapter, qget=1)),
            target='qbar',
        )}}</span>
    <a id="h_queries" href="#">hide queries</a>
</div>
<div id='qbar'>
    {{include 'passage/query_form.html'}}
</div>
{{ pass}}
{{ end }}

{{ if verses != None: }}
        <script type="text/javascript">{{=XML(viewsettings.adjust_view())}}</script>
{{ pass }}
