<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Saving Queries on the BHSA (Hebrew Bible + ETCBC linguistics)
"><meta name=author content="Dirk Roorda"><link href=https://etcbs.github.io/shebanq/server/bymodule/record/ rel=canonical><link rel=icon href=../../../favicon.ico><meta name=generator content="mkdocs-1.2.2, mkdocs-material-7.2.4"><title>Record - SHEBANQ</title><link rel=stylesheet href=../../../assets/stylesheets/main.f7f47774.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_mkdocstrings.css></head> <body dir=ltr data-md-color-scheme data-md-color-primary=none data-md-color-accent=none> <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#record class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=SHEBANQ class="md-header__button md-logo" aria-label=SHEBANQ data-md-component=logo> <img src=../../../images/shebanq_logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SHEBANQ </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Record </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/etcbc/shebanq/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> etcbc/shebanq </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=SHEBANQ class="md-nav__button md-logo" aria-label=SHEBANQ data-md-component=logo> <img src=../../../images/shebanq_logo.png alt=logo> </a> SHEBANQ </label> <div class=md-nav__source> <a href=https://github.com/etcbc/shebanq/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> etcbc/shebanq </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Technical Home </a> </li> <li class=md-nav__item> <a href=../../../news/ class=md-nav__link> News </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Client <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Client data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Client </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../client/ class=md-nav__link> Client </a> </li> <li class=md-nav__item> <a href=../../../client/css/ class=md-nav__link> CSS organization </a> </li> <li class=md-nav__item> <a href=../../../client/js/ class=md-nav__link> Javascript organization </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Bymodule <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Bymodule data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Bymodule </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../client/bymodule/ class=md-nav__link> About modules </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/chart/ class=md-nav__link> Chart </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/colorpicker/ class=md-nav__link> Colorpicker </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/diagnostics/ class=md-nav__link> Diagnostics </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/featuresettings/ class=md-nav__link> Featuresettings </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/helpers/ class=md-nav__link> Helpers </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/localstorage/ class=md-nav__link> Localstorage </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/main/ class=md-nav__link> Main </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/material/ class=md-nav__link> Material </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/materialcontent/ class=md-nav__link> Materialcontent </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/materialsettings/ class=md-nav__link> Materialsettings </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/message/ class=md-nav__link> Message </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/notes/ class=md-nav__link> Notes </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/notetree/ class=md-nav__link> Notetree </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/page/ class=md-nav__link> Page </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/queryrecent/ class=md-nav__link> Queryrecent </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/querytree/ class=md-nav__link> Querytree </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/select/ class=md-nav__link> Select </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/share/ class=md-nav__link> Share </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/sidebars/ class=md-nav__link> Sidebars </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/sidecontent/ class=md-nav__link> Sidecontent </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/sidesettings/ class=md-nav__link> Sidesettings </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/viewstate/ class=md-nav__link> Viewstate </a> </li> <li class=md-nav__item> <a href=../../../client/bymodule/words/ class=md-nav__link> Words </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Deploy <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Deploy data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Deploy </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../deploy/computer/ class=md-nav__link> Computer </a> </li> <li class=md-nav__item> <a href=../../../deploy/documentation/ class=md-nav__link> Documentation </a> </li> <li class=md-nav__item> <a href=../../../deploy/maintenance/ class=md-nav__link> Installation and maintenance </a> </li> <li class=md-nav__item> <a href=../../../deploy/server/ class=md-nav__link> Server </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Elements <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Elements data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Elements </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../elements/ class=md-nav__link> Pages </a> </li> <li class=md-nav__item> <a href=../../../elements/notespage/ class=md-nav__link> Notes pages </a> </li> <li class=md-nav__item> <a href=../../../elements/queriespage/ class=md-nav__link> Queries pages </a> </li> <li class=md-nav__item> <a href=../../../elements/sidebars/ class=md-nav__link> Sidebars </a> </li> <li class=md-nav__item> <a href=../../../elements/textpages/ class=md-nav__link> Text pages </a> </li> <li class=md-nav__item> <a href=../../../elements/wordspage/ class=md-nav__link> Words pages </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6> Server <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Server data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Server </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Server </a> </li> <li class=md-nav__item> <a href=../../controllers/ class=md-nav__link> Controllers </a> </li> <li class=md-nav__item> <a href=../../models/ class=md-nav__link> Models </a> </li> <li class=md-nav__item> <a href=../../views/ class=md-nav__link> Views </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_5 type=checkbox id=__nav_6_5 checked> <label class=md-nav__link for=__nav_6_5> Bymodule <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Bymodule data-md-level=2> <label class=md-nav__title for=__nav_6_5> <span class="md-nav__icon md-icon"></span> Bymodule </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> About modules </a> </li> <li class=md-nav__item> <a href=../blang/ class=md-nav__link> Blang </a> </li> <li class=md-nav__item> <a href=../boiler/ class=md-nav__link> Boiler </a> </li> <li class=md-nav__item> <a href=../books/ class=md-nav__link> Books </a> </li> <li class=md-nav__item> <a href=../caching/ class=md-nav__link> Caching </a> </li> <li class=md-nav__item> <a href=../chart/ class=md-nav__link> Chart </a> </li> <li class=md-nav__item> <a href=../check/ class=md-nav__link> Check </a> </li> <li class=md-nav__item> <a href=../constants/ class=md-nav__link> Constants </a> </li> <li class=md-nav__item> <a href=../csvdata/ class=md-nav__link> Csvdata </a> </li> <li class=md-nav__item> <a href=../dbconfig/ class=md-nav__link> Dbconfig </a> </li> <li class=md-nav__item> <a href=../helpers/ class=md-nav__link> Helpers </a> </li> <li class=md-nav__item> <a href=../materials/ class=md-nav__link> Materials </a> </li> <li class=md-nav__item> <a href=../mql/ class=md-nav__link> Mql </a> </li> <li class=md-nav__item> <a href=../note/ class=md-nav__link> Note </a> </li> <li class=md-nav__item> <a href=../notesave/ class=md-nav__link> Notesave </a> </li> <li class=md-nav__item> <a href=../notesupload/ class=md-nav__link> Notesupload </a> </li> <li class=md-nav__item> <a href=../notetree/ class=md-nav__link> Notetree </a> </li> <li class=md-nav__item> <a href=../query/ class=md-nav__link> Query </a> </li> <li class=md-nav__item> <a href=../querychapter/ class=md-nav__link> Querychapter </a> </li> <li class=md-nav__item> <a href=../queryrecent/ class=md-nav__link> Queryrecent </a> </li> <li class=md-nav__item> <a href=../querysave/ class=md-nav__link> Querysave </a> </li> <li class=md-nav__item> <a href=../querytree/ class=md-nav__link> Querytree </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Record <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Record </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#record class=md-nav__link> record </a> <nav class=md-nav aria-label=record> <ul class=md-nav__list> <li class=md-nav__item> <a href=#record.RECORD class=md-nav__link> RECORD </a> <nav class=md-nav aria-label=RECORD> <ul class=md-nav__list> <li class=md-nav__item> <a href=#record.RECORD.__init__ class=md-nav__link> __init__() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.authWriteGeneric class=md-nav__link> authWriteGeneric() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.authReadGeneric class=md-nav__link> authReadGeneric() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.authRead class=md-nav__link> authRead() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.body class=md-nav__link> body() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.setItem class=md-nav__link> setItem() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.make class=md-nav__link> make() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.update class=md-nav__link> update() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#record.RECORDQUERY class=md-nav__link> RECORDQUERY </a> <nav class=md-nav aria-label=RECORDQUERY> <ul class=md-nav__list> <li class=md-nav__item> <a href=#record.RECORDQUERY.__init__ class=md-nav__link> __init__() </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../side/ class=md-nav__link> Side </a> </li> <li class=md-nav__item> <a href=../test/ class=md-nav__link> Test </a> </li> <li class=md-nav__item> <a href=../urls/ class=md-nav__link> Urls </a> </li> <li class=md-nav__item> <a href=../verse/ class=md-nav__link> Verse </a> </li> <li class=md-nav__item> <a href=../versecontent/ class=md-nav__link> Versecontent </a> </li> <li class=md-nav__item> <a href=../versescontent/ class=md-nav__link> Versescontent </a> </li> <li class=md-nav__item> <a href=../viewdefs/ class=md-nav__link> Viewdefs </a> </li> <li class=md-nav__item> <a href=../viewsettings/ class=md-nav__link> Viewsettings </a> </li> <li class=md-nav__item> <a href=../word/ class=md-nav__link> Word </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> Solutions <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Solutions data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Solutions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../solutions/caching/ class=md-nav__link> Caching </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#record class=md-nav__link> record </a> <nav class=md-nav aria-label=record> <ul class=md-nav__list> <li class=md-nav__item> <a href=#record.RECORD class=md-nav__link> RECORD </a> <nav class=md-nav aria-label=RECORD> <ul class=md-nav__list> <li class=md-nav__item> <a href=#record.RECORD.__init__ class=md-nav__link> __init__() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.authWriteGeneric class=md-nav__link> authWriteGeneric() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.authReadGeneric class=md-nav__link> authReadGeneric() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.authRead class=md-nav__link> authRead() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.body class=md-nav__link> body() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.setItem class=md-nav__link> setItem() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.make class=md-nav__link> make() </a> </li> <li class=md-nav__item> <a href=#record.RECORD.update class=md-nav__link> update() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#record.RECORDQUERY class=md-nav__link> RECORDQUERY </a> <nav class=md-nav aria-label=RECORDQUERY> <ul class=md-nav__list> <li class=md-nav__item> <a href=#record.RECORDQUERY.__init__ class=md-nav__link> __init__() </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/etcbc/shebanq/edit/master/docs/server/bymodule/record.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>Record</h1> <div class="doc doc-object doc-module"> <h2 id=record class="doc doc-heading"> <code>record</code> <a href=#record class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h3 id=record.RECORD class="doc doc-heading"> <code> RECORD </code> <a href=#record.RECORD class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Handles record data.</p> <p>This is about some aspects of query and note records and organization and project records by which they are organized. And it is about word records.</p> <p>It is called by controllers that fetch sidebar material, see <a href=#record.RECORD.body>M:RECORD.body</a>.</p> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h4 id=record.RECORD.__init__ class="doc doc-heading"> <code class="codehilite language-python"><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <span class="doc doc-properties"> <small class="doc doc-property doc-property-special"><code>special</code></small> </span> <a href=#record.RECORD.__init__ class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <details class=quote> <summary>Source code in <code>modules/record.py</code></summary> <div class=codehilite><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
    <span class=k>pass</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 id=record.RECORD.authWriteGeneric class="doc doc-heading"> <code class="codehilite language-python"><span class=n>authWriteGeneric</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>label</span><span class=p>)</span></code> <a href=#record.RECORD.authWriteGeneric class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <details class=quote> <summary>Source code in <code>modules/record.py</code></summary> <div class=codehilite><pre><span></span><code><span class=k>def</span> <span class=nf>authWriteGeneric</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>label</span><span class=p>):</span>
    <span class=n>auth</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>auth</span>

    <span class=n>authorized</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>user</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
    <span class=n>errorMessage</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;You have no access to create/modify a </span><span class=si>{</span><span class=n>label</span><span class=si>}</span><span class=s2>&quot;</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>authorized</span><span class=p>,</span> <span class=s2>&quot;&quot;</span> <span class=k>if</span> <span class=n>authorized</span> <span class=k>else</span> <span class=n>errorMessage</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 id=record.RECORD.authReadGeneric class="doc doc-heading"> <code class="codehilite language-python"><span class=n>authReadGeneric</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>label</span><span class=p>)</span></code> <a href=#record.RECORD.authReadGeneric class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <details class=quote> <summary>Source code in <code>modules/record.py</code></summary> <div class=codehilite><pre><span></span><code><span class=k>def</span> <span class=nf>authReadGeneric</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>label</span><span class=p>):</span>
    <span class=n>authorized</span> <span class=o>=</span> <span class=kc>True</span>
    <span class=n>errorMessage</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>authorized</span><span class=p>,</span> <span class=n>errorMessage</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 id=record.RECORD.authRead class="doc doc-heading"> <code class="codehilite language-python"><span class=n>authRead</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mr</span><span class=p>,</span> <span class=n>qw</span><span class=p>,</span> <span class=n>iidRep</span><span class=p>)</span></code> <a href=#record.RECORD.authRead class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <details class=quote> <summary>Source code in <code>modules/record.py</code></summary> <div class=codehilite><pre><span></span><code><span class=k>def</span> <span class=nf>authRead</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mr</span><span class=p>,</span> <span class=n>qw</span><span class=p>,</span> <span class=n>iidRep</span><span class=p>):</span>

    <span class=k>if</span> <span class=n>mr</span> <span class=o>==</span> <span class=s2>&quot;m&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>qw</span> <span class=o>==</span> <span class=s2>&quot;w&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>qw</span> <span class=o>==</span> <span class=s2>&quot;n&quot;</span><span class=p>:</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>iidRep</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>(</span><span class=kc>False</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;Not a valid note id: </span><span class=si>{</span><span class=n>iidRep</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>qw</span> <span class=o>==</span> <span class=s2>&quot;q&quot;</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>iidRep</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=p>(</span><span class=n>iid</span><span class=p>,</span> <span class=n>keywords</span><span class=p>)</span> <span class=o>=</span> <span class=n>iDecode</span><span class=p>(</span><span class=n>qw</span><span class=p>,</span> <span class=n>iidRep</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>iid</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
                <span class=n>Query</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>Query</span>
                <span class=k>return</span> <span class=n>Query</span><span class=o>.</span><span class=n>authRead</span><span class=p>(</span><span class=n>iid</span><span class=p>)</span>
        <span class=k>return</span> <span class=p>(</span><span class=kc>False</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;Not a valid query id: </span><span class=si>{</span><span class=n>iidRep</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=k>return</span> <span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;Not a valid id: </span><span class=si>{</span><span class=n>iidRep</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 id=record.RECORD.body class="doc doc-heading"> <code class="codehilite language-python"><span class=n>body</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a href=#record.RECORD.body class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Produce data that will get sidebar material later via AJAX.</p> <div class="admonition caution"> <p class=admonition-title>Web2py device</p> <p>We use a <a href={{web2pyComponents}}>web2py device</a> here that shields the mechanics of an AJAX call. That leads to code that is not very clear.</p> <p>These calls are hidden in Web2Py javascript, and you will not find them in the SHEBANQ client app code.</p> </div> <p>This is where the controllers <a href=../../controllers/#controllers.hebrew.sidewordbody>C:hebrew.sidewordbody</a>, <a href=../../controllers/#controllers.hebrew.sidequerybody>C:hebrew.sidequerybody</a> and <a href=../../controllers/#controllers.hebrew.sidenotebody>C:hebrew.sidenotebody</a> will be used.</p> <p>These calls are used when the user requests a <strong>record</strong> page directly. The web2py device takes care that when the sidebar is editable, the edits will be submitted via AJAX. So far so good.</p> <p>However, when a user navigates between <strong>material</strong> pages and <strong>record</strong> pages, the pages are not served from scratch, and new sidebar material has to be fetched through AJAX as well.</p> <p>In the SHEBANQ code we do these AJAX calls explicitly client code: <a href=../../../client/bymodule/sidecontent/#sidecontentfetch>{sidecontent.fetch}</a>.</p> <p>Since I was not able to use the Web2py approach for this part of the use case, it is probably a good idea ditch this usage of the web2py mechanism altogehter in favour fo the more explicit way, which is already in our code. Now we have two ways of doing the same thing! My apologies.</p> <details class=quote> <summary>Source code in <code>modules/record.py</code></summary> <div class=codehilite><pre><span></span><code><span class=k>def</span> <span class=nf>body</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
    <span class=sd>&quot;&quot;&quot;Produce data that will get sidebar material later via AJAX.</span>

<span class=sd>    !!! caution &quot;Web2py device&quot;</span>
<span class=sd>        We use a</span>
<span class=sd>        [web2py device]({{web2pyComponents}})</span>
<span class=sd>        here that shields the mechanics of an AJAX call.</span>
<span class=sd>        That leads to code that is not very clear.</span>

<span class=sd>        These calls are hidden in Web2Py javascript, and you will</span>
<span class=sd>        not find them in the SHEBANQ client app code.</span>

<span class=sd>    This is where the controllers</span>
<span class=sd>    [C:hebrew.sidewordbody][controllers.hebrew.sidewordbody],</span>
<span class=sd>    [C:hebrew.sidequerybody][controllers.hebrew.sidequerybody] and</span>
<span class=sd>    [C:hebrew.sidenotebody][controllers.hebrew.sidenotebody]</span>
<span class=sd>    will be used.</span>

<span class=sd>    These calls are used when the user requests a **record**</span>
<span class=sd>    page directly. The web2py device takes care that when the sidebar</span>
<span class=sd>    is editable, the edits will be submitted via AJAX.</span>
<span class=sd>    So far so good.</span>

<span class=sd>    However, when a user navigates between **material** pages and **record**</span>
<span class=sd>    pages, the pages are not served from scratch, and new sidebar material</span>
<span class=sd>    has to be fetched through AJAX as well.</span>

<span class=sd>    In the SHEBANQ code we do these AJAX calls explicitly</span>
<span class=sd>    client code: [{sidecontent.fetch}][sidecontentfetch].</span>

<span class=sd>    Since I was not able to use the Web2py approach for this part of the use case,</span>
<span class=sd>    it is probably a good idea ditch this usage of the web2py mechanism</span>
<span class=sd>    altogehter in favour fo the more explicit way, which is already in our code.</span>
<span class=sd>    Now we have two ways of doing the same thing!</span>
<span class=sd>    My apologies.</span>
<span class=sd>    &quot;&quot;&quot;</span>  <span class=c1># noqa E501</span>

    <span class=n>Check</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>Check</span>
    <span class=n>LOAD</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>LOAD</span>

    <span class=n>iidRep</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>field</span><span class=p>(</span><span class=s2>&quot;material&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;iid&quot;</span><span class=p>)</span>
    <span class=n>vr</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>field</span><span class=p>(</span><span class=s2>&quot;material&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;version&quot;</span><span class=p>)</span>
    <span class=n>mr</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>field</span><span class=p>(</span><span class=s2>&quot;material&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;mr&quot;</span><span class=p>)</span>
    <span class=n>qw</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>field</span><span class=p>(</span><span class=s2>&quot;material&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;qw&quot;</span><span class=p>)</span>

    <span class=n>kind</span> <span class=o>=</span> <span class=s2>&quot;word&quot;</span> <span class=k>if</span> <span class=n>qw</span> <span class=o>==</span> <span class=s2>&quot;w&quot;</span> <span class=k>else</span> <span class=s2>&quot;query&quot;</span> <span class=k>if</span> <span class=n>qw</span> <span class=o>==</span> <span class=s2>&quot;q&quot;</span> <span class=k>else</span> <span class=s2>&quot;note&quot;</span>

    <span class=p>(</span><span class=n>authorized</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>authRead</span><span class=p>(</span><span class=n>mr</span><span class=p>,</span> <span class=n>qw</span><span class=p>,</span> <span class=n>iidRep</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>authorized</span><span class=p>:</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;fetching </span><span class=si>{</span><span class=n>kind</span><span class=si>}</span><span class=s2>&quot;</span>
    <span class=k>return</span> <span class=nb>dict</span><span class=p>(</span>
        <span class=n>load</span><span class=o>=</span><span class=n>LOAD</span><span class=p>(</span>
            <span class=s2>&quot;hebrew&quot;</span><span class=p>,</span>
            <span class=sa>f</span><span class=s2>&quot;side</span><span class=si>{</span><span class=n>kind</span><span class=si>}</span><span class=s2>body&quot;</span><span class=p>,</span>
            <span class=n>extension</span><span class=o>=</span><span class=s2>&quot;load&quot;</span><span class=p>,</span>
            <span class=nb>vars</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>mr</span><span class=o>=</span><span class=s2>&quot;r&quot;</span><span class=p>,</span> <span class=n>qw</span><span class=o>=</span><span class=s2>&quot;w&quot;</span><span class=p>,</span> <span class=n>version</span><span class=o>=</span><span class=n>vr</span><span class=p>,</span> <span class=n>iid</span><span class=o>=</span><span class=n>iidRep</span><span class=p>),</span>
            <span class=n>ajax</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
            <span class=n>ajax_trap</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=n>target</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>kind</span><span class=si>}</span><span class=s2>body&quot;</span><span class=p>,</span>
            <span class=n>content</span><span class=o>=</span><span class=n>msg</span><span class=p>,</span>
        <span class=p>)</span>
    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 id=record.RECORD.setItem class="doc doc-heading"> <code class="codehilite language-python"><span class=n>setItem</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a href=#record.RECORD.setItem class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Saves a record to the database.</p> <p>Meant for: objects that organize the notes and query overviews: organizations and projects. Can also save query records.</p> <div class="admonition hint"> <p class=admonition-title>Note records and word records</p> <p>Word records are readonly and will nver be saved.</p> <p>There are no such things as note records. Notes are organized in sets bases on keywords and authoring users, but a notes set does not have an embodiment as record in the database.</p> </div> <details class=quote> <summary>Source code in <code>modules/record.py</code></summary> <div class=codehilite><pre><span></span><code><span class=k>def</span> <span class=nf>setItem</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
    <span class=sd>&quot;&quot;&quot;Saves a record to the database.</span>

<span class=sd>    Meant for: objects that organize the notes and query overviews:</span>
<span class=sd>    organizations and projects.</span>
<span class=sd>    Can also save query records.</span>

<span class=sd>    !!! hint &quot;Note records and word records&quot;</span>
<span class=sd>        Word records are readonly and will nver be saved.</span>

<span class=sd>        There are no such things as note records.</span>
<span class=sd>        Notes are organized in sets bases on keywords and authoring users,</span>
<span class=sd>        but a notes set does not have an embodiment as record in the database.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>Check</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>Check</span>
    <span class=n>auth</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>auth</span>

    <span class=n>msgs</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>orgRecord</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=n>projectRecord</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=n>good</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=n>orgGood</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=n>projectGood</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=n>obj_id</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>label</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>table</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>fields</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=n>myId</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>id</span> <span class=k>if</span> <span class=n>auth</span><span class=o>.</span><span class=n>user</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span>

    <span class=n>requestVars</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>vars</span>

    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>1</span><span class=p>]:</span>
        <span class=n>tp</span> <span class=o>=</span> <span class=n>requestVars</span><span class=o>.</span><span class=n>tp</span>
        <span class=k>if</span> <span class=n>tp</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>TPS</span><span class=p>:</span>
            <span class=n>msgs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=s2>&quot;error&quot;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;unknown type </span><span class=si>{</span><span class=n>tp</span><span class=si>}</span><span class=s2>!&quot;</span><span class=p>))</span>
            <span class=k>break</span>
        <span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=n>table</span><span class=p>)</span> <span class=o>=</span> <span class=n>TPS</span><span class=p>[</span><span class=n>tp</span><span class=p>]</span>
        <span class=n>obj_id</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>isId</span><span class=p>(</span><span class=s2>&quot;obj_id&quot;</span><span class=p>,</span> <span class=n>tp</span><span class=p>,</span> <span class=n>label</span><span class=p>,</span> <span class=n>msgs</span><span class=p>)</span>
        <span class=n>upd</span> <span class=o>=</span> <span class=n>requestVars</span><span class=o>.</span><span class=n>upd</span>
        <span class=k>if</span> <span class=n>obj_id</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>break</span>
        <span class=k>if</span> <span class=n>upd</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>{</span><span class=s2>&quot;true&quot;</span><span class=p>,</span> <span class=s2>&quot;false&quot;</span><span class=p>}:</span>
            <span class=n>msgs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=s2>&quot;error&quot;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;invalid instruction </span><span class=si>{</span><span class=n>upd</span><span class=si>}</span><span class=s2>!&quot;</span><span class=p>))</span>
            <span class=k>break</span>
        <span class=n>upd</span> <span class=o>=</span> <span class=kc>True</span> <span class=k>if</span> <span class=n>upd</span> <span class=o>==</span> <span class=s2>&quot;true&quot;</span> <span class=k>else</span> <span class=kc>False</span>
        <span class=k>if</span> <span class=n>upd</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>myId</span><span class=p>:</span>
            <span class=n>msgs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=s2>&quot;error&quot;</span><span class=p>,</span> <span class=s2>&quot;for updating you have to be logged in!&quot;</span><span class=p>))</span>
            <span class=k>break</span>
        <span class=n>fields</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span>

        <span class=k>if</span> <span class=n>tp</span> <span class=o>==</span> <span class=s2>&quot;q&quot;</span><span class=p>:</span>
            <span class=n>Query</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>Query</span>
            <span class=n>fields</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;organization&quot;</span><span class=p>)</span>
            <span class=n>fields</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;project&quot;</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>fields</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;website&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>upd</span><span class=p>:</span>
            <span class=p>(</span><span class=n>authorized</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span> <span class=o>=</span> <span class=p>(</span>
                <span class=n>Query</span><span class=o>.</span><span class=n>authWrite</span><span class=p>(</span><span class=n>obj_id</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>tp</span> <span class=o>==</span> <span class=s2>&quot;q&quot;</span>
                <span class=k>else</span> <span class=bp>self</span><span class=o>.</span><span class=n>authWriteGeneric</span><span class=p>(</span><span class=n>label</span><span class=p>)</span>
            <span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=p>(</span><span class=n>authorized</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span> <span class=o>=</span> <span class=p>(</span>
                <span class=n>Query</span><span class=o>.</span><span class=n>authRead</span><span class=p>(</span><span class=n>obj_id</span><span class=p>)</span> <span class=k>if</span> <span class=n>tp</span> <span class=o>==</span> <span class=s2>&quot;q&quot;</span> <span class=k>else</span> <span class=bp>self</span><span class=o>.</span><span class=n>authReadGeneric</span><span class=p>(</span><span class=n>label</span><span class=p>)</span>
            <span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>authorized</span><span class=p>:</span>
            <span class=n>msgs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=s2>&quot;error&quot;</span><span class=p>,</span> <span class=n>msg</span><span class=p>))</span>
            <span class=k>break</span>
        <span class=k>if</span> <span class=n>upd</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>tp</span> <span class=o>==</span> <span class=s2>&quot;q&quot;</span><span class=p>:</span>
                <span class=n>subfields</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;website&quot;</span><span class=p>]</span>
                <span class=n>fieldValues</span> <span class=o>=</span> <span class=p>[</span><span class=n>requestVars</span><span class=o>.</span><span class=n>name</span><span class=p>]</span>
                <span class=n>doNewOrg</span> <span class=o>=</span> <span class=n>requestVars</span><span class=o>.</span><span class=n>doNewOrg</span>
                <span class=n>doNewProject</span> <span class=o>=</span> <span class=n>requestVars</span><span class=o>.</span><span class=n>doNewProject</span>
                <span class=k>if</span> <span class=n>doNewOrg</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>{</span><span class=s2>&quot;true&quot;</span><span class=p>,</span> <span class=s2>&quot;false&quot;</span><span class=p>}:</span>
                    <span class=n>msgs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
                        <span class=p>(</span>
                            <span class=s2>&quot;error&quot;</span><span class=p>,</span>
                            <span class=sa>f</span><span class=s2>&quot;invalid instruction for organization </span><span class=si>{</span><span class=n>doNewOrg</span><span class=si>}</span><span class=s2>!&quot;</span><span class=p>,</span>
                        <span class=p>)</span>
                    <span class=p>)</span>
                    <span class=k>break</span>
                <span class=n>doNewOrg</span> <span class=o>=</span> <span class=n>doNewOrg</span> <span class=o>==</span> <span class=s2>&quot;true&quot;</span>
                <span class=k>if</span> <span class=n>doNewProject</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>{</span><span class=s2>&quot;true&quot;</span><span class=p>,</span> <span class=s2>&quot;false&quot;</span><span class=p>}:</span>
                    <span class=n>msgs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
                        <span class=p>(</span>
                            <span class=s2>&quot;error&quot;</span><span class=p>,</span>
                            <span class=sa>f</span><span class=s2>&quot;invalid instruction for project </span><span class=si>{</span><span class=n>doNewProject</span><span class=si>}</span><span class=s2>!&quot;</span><span class=p>,</span>
                        <span class=p>)</span>
                    <span class=p>)</span>
                    <span class=k>break</span>
                <span class=n>doNewProject</span> <span class=o>=</span> <span class=n>doNewProject</span> <span class=o>==</span> <span class=s2>&quot;true&quot;</span>
                <span class=n>orgGood</span> <span class=o>=</span> <span class=kc>True</span>
                <span class=k>if</span> <span class=n>doNewOrg</span><span class=p>:</span>
                    <span class=p>(</span><span class=n>orgGood</span><span class=p>,</span> <span class=n>org_id</span><span class=p>)</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
                        <span class=s2>&quot;o&quot;</span><span class=p>,</span>
                        <span class=mi>0</span><span class=p>,</span>
                        <span class=n>myId</span><span class=p>,</span>
                        <span class=n>subfields</span><span class=p>,</span>
                        <span class=p>[</span><span class=n>requestVars</span><span class=o>.</span><span class=n>org_name</span><span class=p>,</span> <span class=n>requestVars</span><span class=o>.</span><span class=n>org_website</span><span class=p>],</span>
                        <span class=n>msgs</span><span class=p>,</span>
                    <span class=p>)</span>
                    <span class=k>if</span> <span class=n>orgGood</span><span class=p>:</span>
                        <span class=n>orgRecord</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span>
                            <span class=nb>id</span><span class=o>=</span><span class=n>org_id</span><span class=p>,</span>
                            <span class=n>name</span><span class=o>=</span><span class=n>requestVars</span><span class=o>.</span><span class=n>org_name</span><span class=p>,</span>
                            <span class=n>website</span><span class=o>=</span><span class=n>requestVars</span><span class=o>.</span><span class=n>org_website</span><span class=p>,</span>
                        <span class=p>)</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>org_id</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>isId</span><span class=p>(</span><span class=s2>&quot;org_id&quot;</span><span class=p>,</span> <span class=s2>&quot;o&quot;</span><span class=p>,</span> <span class=n>TPS</span><span class=p>[</span><span class=s2>&quot;o&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>msgs</span><span class=p>)</span>
                <span class=n>projectGood</span> <span class=o>=</span> <span class=kc>True</span>
                <span class=k>if</span> <span class=n>doNewProject</span><span class=p>:</span>
                    <span class=p>(</span><span class=n>projectGood</span><span class=p>,</span> <span class=n>project_id</span><span class=p>)</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
                        <span class=s2>&quot;p&quot;</span><span class=p>,</span>
                        <span class=mi>0</span><span class=p>,</span>
                        <span class=n>myId</span><span class=p>,</span>
                        <span class=n>subfields</span><span class=p>,</span>
                        <span class=p>[</span><span class=n>requestVars</span><span class=o>.</span><span class=n>project_name</span><span class=p>,</span> <span class=n>requestVars</span><span class=o>.</span><span class=n>project_website</span><span class=p>],</span>
                        <span class=n>msgs</span><span class=p>,</span>
                    <span class=p>)</span>
                    <span class=k>if</span> <span class=n>projectGood</span><span class=p>:</span>
                        <span class=n>projectRecord</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span>
                            <span class=nb>id</span><span class=o>=</span><span class=n>project_id</span><span class=p>,</span>
                            <span class=n>name</span><span class=o>=</span><span class=n>requestVars</span><span class=o>.</span><span class=n>project_name</span><span class=p>,</span>
                            <span class=n>website</span><span class=o>=</span><span class=n>requestVars</span><span class=o>.</span><span class=n>project_website</span><span class=p>,</span>
                        <span class=p>)</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>project_id</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>isId</span><span class=p>(</span><span class=s2>&quot;project_id&quot;</span><span class=p>,</span> <span class=s2>&quot;p&quot;</span><span class=p>,</span> <span class=n>TPS</span><span class=p>[</span><span class=s2>&quot;o&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>msgs</span><span class=p>)</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=n>orgGood</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>projectGood</span><span class=p>:</span>
                    <span class=k>break</span>
                <span class=k>if</span> <span class=n>org_id</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>project_id</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=k>break</span>
                <span class=n>fieldValues</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>org_id</span><span class=p>,</span> <span class=n>project_id</span><span class=p>])</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>fieldValues</span> <span class=o>=</span> <span class=p>[</span><span class=n>requestVars</span><span class=p>[</span><span class=n>field</span><span class=p>]</span> <span class=k>for</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>fields</span><span class=p>]</span>

            <span class=p>(</span><span class=n>good</span><span class=p>,</span> <span class=n>obj_idNew</span><span class=p>)</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
                <span class=n>tp</span><span class=p>,</span> <span class=n>obj_id</span><span class=p>,</span> <span class=n>myId</span><span class=p>,</span> <span class=n>fields</span><span class=p>,</span> <span class=n>fieldValues</span><span class=p>,</span> <span class=n>msgs</span>
            <span class=p>)</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>good</span><span class=p>:</span>
                <span class=k>break</span>
            <span class=n>obj_id</span> <span class=o>=</span> <span class=n>obj_idNew</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>good</span> <span class=o>=</span> <span class=kc>True</span>

    <span class=n>record</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>make</span><span class=p>(</span><span class=n>tp</span><span class=p>,</span> <span class=n>label</span><span class=p>,</span> <span class=n>table</span><span class=p>,</span> <span class=n>fields</span><span class=p>,</span> <span class=n>obj_id</span><span class=p>,</span> <span class=n>good</span><span class=p>,</span> <span class=n>msgs</span><span class=p>)</span>

    <span class=k>return</span> <span class=nb>dict</span><span class=p>(</span>
        <span class=n>data</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span>
            <span class=nb>dict</span><span class=p>(</span>
                <span class=n>record</span><span class=o>=</span><span class=n>record</span><span class=p>,</span>
                <span class=n>orgRecord</span><span class=o>=</span><span class=n>orgRecord</span><span class=p>,</span>
                <span class=n>projectRecord</span><span class=o>=</span><span class=n>projectRecord</span><span class=p>,</span>
                <span class=n>msgs</span><span class=o>=</span><span class=n>msgs</span><span class=p>,</span>
                <span class=n>good</span><span class=o>=</span><span class=n>good</span><span class=p>,</span>
                <span class=n>orgGood</span><span class=o>=</span><span class=n>orgGood</span><span class=p>,</span>
                <span class=n>projectGood</span><span class=o>=</span><span class=n>projectGood</span><span class=p>,</span>
            <span class=p>)</span>
        <span class=p>)</span>
    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 id=record.RECORD.make class="doc doc-heading"> <code class="codehilite language-python"><span class=n>make</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tp</span><span class=p>,</span> <span class=n>label</span><span class=p>,</span> <span class=n>table</span><span class=p>,</span> <span class=n>fields</span><span class=p>,</span> <span class=n>obj_id</span><span class=p>,</span> <span class=n>good</span><span class=p>,</span> <span class=n>msgs</span><span class=p>)</span></code> <a href=#record.RECORD.make class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <details class=quote> <summary>Source code in <code>modules/record.py</code></summary> <div class=codehilite><pre><span></span><code><span class=k>def</span> <span class=nf>make</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tp</span><span class=p>,</span> <span class=n>label</span><span class=p>,</span> <span class=n>table</span><span class=p>,</span> <span class=n>fields</span><span class=p>,</span> <span class=n>obj_id</span><span class=p>,</span> <span class=n>good</span><span class=p>,</span> <span class=n>msgs</span><span class=p>):</span>
    <span class=n>db</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>db</span>

    <span class=n>record</span> <span class=o>=</span> <span class=p>{}</span>

    <span class=k>if</span> <span class=n>good</span><span class=p>:</span>
        <span class=n>dbRecord</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=k>if</span> <span class=n>tp</span> <span class=o>==</span> <span class=s2>&quot;q&quot;</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>obj_id</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
                <span class=n>dbRecord</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>]</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>Query</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>Query</span>
                <span class=n>dbRecord</span> <span class=o>=</span> <span class=n>Query</span><span class=o>.</span><span class=n>getTreeInfo</span><span class=p>(</span><span class=n>obj_id</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>obj_id</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
                <span class=n>dbRecord</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>]</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>dbRecord</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>executesql</span><span class=p>(</span>
                    <span class=n>dedent</span><span class=p>(</span>
                        <span class=sa>f</span><span class=s2>&quot;&quot;&quot;</span>
<span class=s2>                        select </span><span class=si>{</span><span class=s2>&quot;,&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>fields</span><span class=p>)</span><span class=si>}</span><span class=s2></span>
<span class=s2>                        from </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2></span>
<span class=s2>                        where id = </span><span class=si>{</span><span class=n>obj_id</span><span class=si>}</span><span class=s2></span>
<span class=s2>                        ;</span>
<span class=s2>                        &quot;&quot;&quot;</span>
                    <span class=p>),</span>
                    <span class=n>as_dict</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
        <span class=k>if</span> <span class=n>dbRecord</span><span class=p>:</span>
            <span class=n>record</span> <span class=o>=</span> <span class=n>dbRecord</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>msgs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=s2>&quot;error&quot;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;No </span><span class=si>{</span><span class=n>label</span><span class=si>}</span><span class=s2> with id </span><span class=si>{</span><span class=n>obj_id</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>))</span>

    <span class=k>return</span> <span class=n>record</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 id=record.RECORD.update class="doc doc-heading"> <code class="codehilite language-python"><span class=n>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tp</span><span class=p>,</span> <span class=n>obj_id</span><span class=p>,</span> <span class=n>myId</span><span class=p>,</span> <span class=n>fields</span><span class=p>,</span> <span class=n>fieldValues</span><span class=p>,</span> <span class=n>msgs</span><span class=p>)</span></code> <a href=#record.RECORD.update class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <details class=quote> <summary>Source code in <code>modules/record.py</code></summary> <div class=codehilite><pre><span></span><code><span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tp</span><span class=p>,</span> <span class=n>obj_id</span><span class=p>,</span> <span class=n>myId</span><span class=p>,</span> <span class=n>fields</span><span class=p>,</span> <span class=n>fieldValues</span><span class=p>,</span> <span class=n>msgs</span><span class=p>):</span>
    <span class=n>Check</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>Check</span>
    <span class=n>db</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>db</span>

    <span class=n>fieldsUpd</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=n>good</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=n>table</span><span class=p>)</span> <span class=o>=</span> <span class=n>TPS</span><span class=p>[</span><span class=n>tp</span><span class=p>]</span>
    <span class=n>useValues</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>fields</span><span class=p>)):</span>
        <span class=n>field</span> <span class=o>=</span> <span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
        <span class=n>value</span> <span class=o>=</span> <span class=n>fieldValues</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
        <span class=n>useValues</span><span class=p>[</span><span class=n>field</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>

    <span class=n>now</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>utcnow</span>

    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>1</span><span class=p>]:</span>
        <span class=n>valSql</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>isName</span><span class=p>(</span>
            <span class=n>tp</span><span class=p>,</span>
            <span class=n>obj_id</span><span class=p>,</span>
            <span class=n>myId</span><span class=p>,</span>
            <span class=n>useValues</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
            <span class=n>msgs</span><span class=p>,</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=n>valSql</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>break</span>
        <span class=n>fieldsUpd</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>valSql</span>
        <span class=k>if</span> <span class=n>tp</span> <span class=o>==</span> <span class=s2>&quot;q&quot;</span><span class=p>:</span>
            <span class=n>val</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>isId</span><span class=p>(</span>
                <span class=s2>&quot;org_id&quot;</span><span class=p>,</span>
                <span class=s2>&quot;o&quot;</span><span class=p>,</span>
                <span class=n>TPS</span><span class=p>[</span><span class=s2>&quot;o&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span>
                <span class=n>msgs</span><span class=p>,</span>
                <span class=n>valrep</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>useValues</span><span class=p>[</span><span class=s2>&quot;organization&quot;</span><span class=p>]),</span>
            <span class=p>)</span>
            <span class=k>if</span> <span class=n>val</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>break</span>
            <span class=n>valSql</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>isRel</span><span class=p>(</span><span class=s2>&quot;o&quot;</span><span class=p>,</span> <span class=n>val</span><span class=p>,</span> <span class=n>msgs</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>valSql</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>break</span>
            <span class=n>fieldsUpd</span><span class=p>[</span><span class=s2>&quot;organization&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>valSql</span>
            <span class=n>val</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>isId</span><span class=p>(</span>
                <span class=s2>&quot;project_id&quot;</span><span class=p>,</span>
                <span class=s2>&quot;p&quot;</span><span class=p>,</span>
                <span class=n>TPS</span><span class=p>[</span><span class=s2>&quot;p&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span>
                <span class=n>msgs</span><span class=p>,</span>
                <span class=n>valrep</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>useValues</span><span class=p>[</span><span class=s2>&quot;project&quot;</span><span class=p>]),</span>
            <span class=p>)</span>
            <span class=n>valSql</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>isRel</span><span class=p>(</span><span class=s2>&quot;p&quot;</span><span class=p>,</span> <span class=n>val</span><span class=p>,</span> <span class=n>msgs</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>valSql</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>break</span>
            <span class=n>fieldsUpd</span><span class=p>[</span><span class=s2>&quot;project&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>valSql</span>
            <span class=n>fld</span> <span class=o>=</span> <span class=s2>&quot;modified_on&quot;</span>
            <span class=n>fieldsUpd</span><span class=p>[</span><span class=n>fld</span><span class=p>]</span> <span class=o>=</span> <span class=n>now</span>
            <span class=n>fields</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fld</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>obj_id</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
                <span class=n>fld</span> <span class=o>=</span> <span class=s2>&quot;created_on&quot;</span>
                <span class=n>fieldsUpd</span><span class=p>[</span><span class=n>fld</span><span class=p>]</span> <span class=o>=</span> <span class=n>now</span>
                <span class=n>fields</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fld</span><span class=p>)</span>
                <span class=n>fld</span> <span class=o>=</span> <span class=s2>&quot;created_by&quot;</span>
                <span class=n>fieldsUpd</span><span class=p>[</span><span class=n>fld</span><span class=p>]</span> <span class=o>=</span> <span class=n>myId</span>
                <span class=n>fields</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fld</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>valSql</span> <span class=o>=</span> <span class=n>Check</span><span class=o>.</span><span class=n>isWebsite</span><span class=p>(</span><span class=n>tp</span><span class=p>,</span> <span class=n>useValues</span><span class=p>[</span><span class=s2>&quot;website&quot;</span><span class=p>],</span> <span class=n>msgs</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>valSql</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>break</span>
            <span class=n>fieldsUpd</span><span class=p>[</span><span class=s2>&quot;website&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>valSql</span>
        <span class=n>good</span> <span class=o>=</span> <span class=kc>True</span>
    <span class=k>if</span> <span class=n>good</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>obj_id</span><span class=p>:</span>
            <span class=n>fieldVals</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot; </span><span class=si>{</span><span class=n>f</span><span class=si>}</span><span class=s2> = &#39;</span><span class=si>{</span><span class=n>fieldsUpd</span><span class=p>[</span><span class=n>f</span><span class=p>]</span><span class=si>}</span><span class=s2>&#39;&quot;</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>fields</span><span class=p>]</span>
            <span class=n>sql</span> <span class=o>=</span> <span class=n>dedent</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;&quot;&quot;</span>
<span class=s2>                update </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2></span>
<span class=s2>                set</span><span class=si>{</span><span class=s2>&quot;,&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>fieldVals</span><span class=p>)</span><span class=si>}</span><span class=s2></span>
<span class=s2>                where id = </span><span class=si>{</span><span class=n>obj_id</span><span class=si>}</span><span class=s2></span>
<span class=s2>                ;</span>
<span class=s2>                &quot;&quot;&quot;</span>
            <span class=p>)</span>
            <span class=n>thisMsg</span> <span class=o>=</span> <span class=s2>&quot;updated&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>fieldVals</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>fieldsUpd</span><span class=p>[</span><span class=n>f</span><span class=p>]</span><span class=si>}</span><span class=s2>&#39;&quot;</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>fields</span><span class=p>]</span>
            <span class=n>sql</span> <span class=o>=</span> <span class=n>dedent</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;&quot;&quot;</span>
<span class=s2>                insert into </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2></span>
<span class=s2>                (</span><span class=si>{</span><span class=s2>&quot;,&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>fields</span><span class=p>)</span><span class=si>}</span><span class=s2>)</span>
<span class=s2>                values (</span><span class=si>{</span><span class=s2>&quot;,&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>fieldVals</span><span class=p>)</span><span class=si>}</span><span class=s2>)</span>
<span class=s2>                ;</span>
<span class=s2>                &quot;&quot;&quot;</span>
            <span class=p>)</span>
            <span class=n>thisMsg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>label</span><span class=si>}</span><span class=s2> added&quot;</span>

        <span class=n>db</span><span class=o>.</span><span class=n>executesql</span><span class=p>(</span><span class=n>sql</span><span class=p>)</span>

        <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>

        <span class=k>if</span> <span class=n>obj_id</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
            <span class=n>obj_id</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>executesql</span><span class=p>(</span>
                <span class=n>dedent</span><span class=p>(</span>
                    <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>                select last_insert_id() as x</span>
<span class=sd>                ;</span>
<span class=sd>                &quot;&quot;&quot;</span>
                <span class=p>)</span>
            <span class=p>)[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>

        <span class=n>msgs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=s2>&quot;good&quot;</span><span class=p>,</span> <span class=n>thisMsg</span><span class=p>))</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>good</span><span class=p>,</span> <span class=n>obj_id</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=record.RECORDQUERY class="doc doc-heading"> <code> RECORDQUERY (<a title=record.RECORD href=#record.RECORD>RECORD</a>) </code> <a href=#record.RECORDQUERY class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h4 id=record.RECORDQUERY.__init__ class="doc doc-heading"> <code class="codehilite language-python"><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>Query</span><span class=p>)</span></code> <span class="doc doc-properties"> <small class="doc doc-property doc-property-special"><code>special</code></small> </span> <a href=#record.RECORDQUERY.__init__ class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <details class=quote> <summary>Source code in <code>modules/record.py</code></summary> <div class=codehilite><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>Query</span><span class=p>):</span>
    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>Query</span> <span class=o>=</span> <span class=n>Query</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <hr> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../querytree/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Querytree" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Querytree </div> </div> </a> <a href=../side/ class="md-footer__link md-footer__link--next" aria-label="Next: Side" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Side </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script> <script src=../../../assets/javascripts/bundle.febc23d1.min.js></script> </body> </html>